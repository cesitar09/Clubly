using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data.Objects.DataClasses;
using System.ComponentModel.DataAnnotations;

namespace Web.Models
{
    public class Familia
    {
        [Display(Name = "Código Familia")]
        [Required]
        public short id { get; set; }

        [Display(Name = "Tipo")]
        [Required]
        public short tipo { get; set; }

        [Display(Name = "Saldo")]
        [Required]
        public double saldo { get; set; }

        [Display(Name = "Estado")]
        public short estado { get; set; }

        [Display(Name = "Usuario")]
        public Usuario usuario { get; set; }

        public Socio socioTitular { get; set; }

        //metodos para convertir
        public Familia() { }
        public Familia(Datos.Familia familia)
        {
            id = familia.id;
            tipo = familia.tipo;
            saldo = familia.saldo;
            estado = familia.estado;
            usuario = Usuario.Convertir(familia.Usuario);
            socioTitular = Socio.Convertir((Negocio.Socio.buscarIdFamilia(familia.id)).FirstOrDefault());
        }
        public static Models.Familia Convertir(Datos.Familia familia)
        {
            return new Familia(familia);
        }
        public static IEnumerable<Models.Familia> ConvertirLista(IEnumerable<Datos.Familia> listaFamilia)
        {
            return listaFamilia.Select(persona => Convertir(persona));
        }
        public static Datos.Familia Invertir(Models.Familia familia) 
        {
            Datos.Familia datosFamilia;
            if (familia.id == 0)
                datosFamilia = new Datos.Familia();
            else
                datosFamilia = Negocio.Familia.buscarId(familia.id);
            datosFamilia.id = familia.id;
            datosFamilia.tipo = familia.tipo;
            datosFamilia.saldo = familia.saldo;
            datosFamilia.estado = familia.estado;
            datosFamilia.Usuario = Usuario.Invertir(familia.usuario);
            return datosFamilia; 
        }
        public static IEnumerable<Models.Familia> SeleccionarTodo()
        {
            return ConvertirLista(Negocio.Familia.seleccionarTodo());
        }
        public static Models.Familia buscarId(short id)
        {
            return Convertir(Negocio.Familia.buscarId(id));
        }

        public Models.Socio SocioTitular()
        {
            return Socio.Convertir((Negocio.Socio.buscarIdFamilia(id)).FirstOrDefault());
            //return (Negocio.Socio.buscarIdFamilia(id)).Select(socio => socio.tipo == Socio.TITULAR);
        }
    }
}