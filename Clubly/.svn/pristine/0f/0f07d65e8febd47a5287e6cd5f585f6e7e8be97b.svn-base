using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Datos;
using System.Collections;
namespace Negocio
{
    public class Usuario
    {

       

        public static Exception insertar(Datos.Usuario usuario)
        {
            try
            {
                Datos.Context.context().Usuario.AddObject(usuario);
                Datos.Context.context().SaveChanges();
            }catch(Exception ex)
            {
                return ex;
            }
            return null;
        }

        public static IEnumerable<Datos.Usuario> seleccionarTodo()
        {
            List<Datos.Usuario> listaUsuarios = Datos.Context.context().Usuario.ToList();  
            return listaUsuarios;
        }

        public static Datos.Usuario buscarId(short id)
        {
            Datos.Usuario usuario = Datos.Context.context().Usuario.Single(p => p.id == id);
            return usuario;
        }

        public static Exception modificar(Datos.Usuario usuario)
        {
            try
            {
                var auxUsuario = Datos.Context.context().Usuario.Single(p => p.id == usuario.id);
                auxUsuario.contrasena = usuario.contrasena;
                //auxUsuario.Empleado = usuario.Empleado;
                auxUsuario.estado = usuario.estado;
                //auxUsuario.Familia = usuario.Familia;
                auxUsuario.nomUsuario = usuario.nomUsuario;
                auxUsuario.Perfil = Negocio.Perfil.seleccionarTodo().Single(p => p.id == usuario.Perfil.id);
                //auxUsuario.Permiso = usuario.Permiso;
                Datos.Context.context().SaveChanges();
            }
            catch (Exception ex)
            {
                return ex;
            }
            return null;
        }

        public static bool esValido(short id, String contrasena)
        {
            try
            {
                if (Datos.Context.context().Usuario.Any(p => p.id == id && p.contrasena == contrasena))
                {
                    return true;
                }
                else
                {
                    return false;
                }
            }
            catch (Exception ex)
            {
                return false;
            }
        }
    }
}
